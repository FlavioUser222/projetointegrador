<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Relatorios</title>
    <link rel="shortcut icon" href="logo.png" type="image/x-icon">
    <link rel="stylesheet" href="controler.css">
</head>
<style>
    img {
        width: 200px;
        height: 180px;
    }

    .videoCard {
        border-radius: 10px;
        border: 1px solid rgb(34, 33, 33);
        padding: 10px;
    }
</style>

<body>

    <button id="menu-btn">‚ò∞</button>


    <div class="sidebar" id="sidebar">
        <div class="icons">
            <a href="index.html">üè†<span>Home</span></a>
            <a href="videoCad.html">‚öôÔ∏è<span>Cadastrar V√≠deo</span></a>
            <a href="controler.html">üé• <span>Gerenciar V√≠deos</span></a>
            <a href="relatorios.html">üìã<span>Relat√≥rio dos V√≠deos</span></a>
        </div>
    </div>
    <div class="container">
        <h1>Relatorios</h1>
        <div class="content" id="content">
            <div class="videosContent" id="videosContent">

            </div>
        </div>



        
    </div>

    <script>

        const menuBtn = document.getElementById('menu-btn');
        const sidebar = document.getElementById('sidebar');
        const videoEditadoId = null

        menuBtn.addEventListener('click', () => {
            sidebar.classList.toggle('show');
        });








        let videos = []
        let relatorios = []
        async function mostrarVideo() {
            try {
                let res = await fetch('https://projeto-pi-onrender.onrender.com/videos');
                videos = await res.json()
                let resRelatorios = await fetch('https://projeto-pi-onrender.onrender.com/avaliacoes/percentual')
                relatorios = await resRelatorios.json()
                let videosContent = document.getElementById('videosContent');

                videos.forEach((video) => {
                    let videoCard = document.createElement('div')
                    let img = document.createElement('img')
                    videoCard.className = "videoCard"
                    let h1 = document.createElement('h1')
                    h1.textContent = video.nome
                    if (video.thumbnail) {
                        img.src = `https://projeto-pi-onrender.onrender.com/uploads/${video.thumbnail}`;
                        img.alt = `Thumbnail do v√≠deo ${video.nome}`;
                    } else {
                        img.src = 'img/sem-thumb.png';
                        img.alt = 'Sem thumbnail dispon√≠vel';
                    }
                    let percentualObj = relatorios.find(p => p.video_id === video.id);
                    let percentual = percentualObj ? parseFloat(percentualObj.media).toFixed(1) : "0.0";
                    let media = percentualObj ? parseFloat(percentualObj.percentual).toFixed(1) : "0.0";
                    let totalAvaliacoes = percentualObj ? percentualObj.total_avaliacoes : "0";

                    let p = document.createElement('p');
                    p.textContent = `M√©dia: ${percentual} | Percentual: ${media}% | Total de avalia√ß√µes: ${totalAvaliacoes}`;


                    videoCard.appendChild(img)
                    videoCard.appendChild(h1)
                    videoCard.appendChild(p)
                    videosContent.appendChild(videoCard)


                });
            } catch (err) {
                console.error('Erro ao carregar v√≠deos:', err);
            }
        }
        mostrarVideo()
    </script>
</body>

</html>